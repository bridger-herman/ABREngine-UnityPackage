<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Creating your first C# ABR Visualization | ABREngine </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Creating your first C# ABR Visualization | ABREngine ">
    <meta name="generator" content="docfx 2.58.4.0">
    
    <link rel="shortcut icon" href="../resources/favicon.ico">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc">
    <meta property="docfx:tocrel" content="toc">
    
    <meta property="docfx:rel" content="../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../resources/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
                
                <ul class="nav level1 navbar-nav">
                      <li>
                          <a href="../index.html" title="Home">Home</a>
                      </li>
                      <li>
                          <a href="../manual/intro.html" title="Manual">Manual</a>
                      </li>
                      <li>
                          <a href="../api/index.html" title="API Documentation">API Documentation</a>
                      </li>
                </ul>    </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div>
              <div class="sidefilter">
                <form class="toc-filter">
                  <span class="glyphicon glyphicon-filter filter-icon"></span>
                  <input type="text" id="toc_filter_input" placeholder="Enter here to filter..." onkeypress="if(event.keyCode==13) {return false;}">
                </form>
              </div>
              <div class="sidetoc">
                <div class="toc" id="toc">
                  
                  <ul class="nav level1">
                    <li class="">
                      <a href="install.html" title="Installation" class="">Installation</a>
                    </li>
                    <li class="">
                      <a href="intro.html" title="Introduction" class="">Introduction</a>
                    </li>
                    <li class="">
                      <span class="expand-stub"></span>
                      <a href="core-concepts.html" title="Core Concepts" class="">Core Concepts</a>
                        
                        <ul class="nav level2">
                          <li class="">
                            <a href="key-data.html" title="Key Data" class="">Key Data</a>
                          </li>
                          <li class="">
                            <a href="visassets.html" title="VisAssets" class="">VisAssets</a>
                          </li>
                          <li class="">
                            <a href="data-impressions.html" title="Data Impressions" class="">Data Impressions</a>
                          </li>
                          <li class="">
                            <a href="terminology-starter.html" title="Basic Terminology" class="">Basic Terminology</a>
                          </li>
                          <li class="">
                            <a href="media-folder.html" title="Media Folder" class="">Media Folder</a>
                          </li>
                        </ul>  </li>
                    <li class="active">
                      <a href="creating-cs-abr-vis.html" title="Creating your first ABR C# Visualization" class="active">Creating your first ABR C# Visualization</a>
                    </li>
                    <li class="">
                      <a href="license.html" title="License" class="">License</a>
                    </li>
                    <li class="">
                      <a href="changelog.html" title="Change Log" class="">Change Log</a>
                    </li>
                  </ul>        </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="creating-your-first-c-abr-visualization">Creating your first C# ABR Visualization</h1>

<p>Before you begin, make sure you have Unity open and have followed the <a href="install.html">ABR install instructions</a>.</p>
<p>During this tutorial, we&#39;ll make a visualization of some 3D surface data like this:
<img src="resources/cs-vis-teaser.png" alt=""></p>
<h2 id="part-0-getting-used-to-c-syntax-and-the-abrengine">Part 0: Getting used to C# Syntax and the ABREngine</h2>
<p>Even if you&#39;ve done lots of C# Scripting previously, this part is still worth reading because it&#39;s important to be aware of a few design patterns the ABREngine uses.</p>
<h3 id="tip-1-use-of-instance">Tip 1: Use of <code>.Instance</code></h3>
<p>Like other object-oriented programming languages, C# uses classes, and you
access the member variables and functions of those classes with a <code>.</code>  So, in
the line above, <a class="xref" href="../api/IVLab.ABREngine.ABREngine.html">ABREngine</a> is a class (one of the most important in ABR), and
<code>.Instance</code> refers to a member variable inside the ABREngine class.  Whenever
you see a member variable named <code>Instance</code>, it&#39;s a good bet that this code is
using a <a href="https://www.c-sharpcorner.com/UploadFile/8911c4/singleton-design-pattern-in-C-Sharp/">Singleton Design Pattern</a>.  In short, this means it is a class that is
used sort of like a global variable, where the code enforces that only one
instance of this class can ever exist within the program.  In Unity programming,
you will see this used a lot for classes that are &quot;in charge&quot; of coordinating or
sharing important resources across the whole program, so often these will be
named &quot;Engine&quot; or &quot;Manager&quot; or something similar.  It&#39;s a good practice to make
such classes &quot;singletons&quot; when your code assumes you will never have more than
one &quot;engine&quot; or &quot;manager&quot;.  The convention is that you can refer to this single
instance of the engine or manager class from anywhere in your program by simply
writing <code>Classname.Instance</code> -- in this case, <code>ABREngine.Instance</code>.</p>
<h3 id="tip-2-c-properties">Tip 2: C# Properties</h3>
<p>Since <code>ABREngine.Instance</code> refers to the single instance of the ABREngine class
that exists in our program, anything that comes after this must be a member
variable, property, or function of the ABREngine class.  If you go to the
ABREngine documentation and scroll down a bit, you&#39;ll find VisAssets listed
under the &quot;Properties&quot; section. In C#, <a href="https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/properties">Properties</a> are used like getter/setting
methods in many other languages - they just provide access to get and/or set data
stored internally in the class.</p>
<h3 id="tip-3-generics-with--notation">Tip 3: Generics with &lt;&gt; Notation</h3>
<p>Many ABREngine methods have a generic type parameter in angle brackets, for example <code>ABREngine.Instance.VisAssets.LoadVisAsset&lt;ColormapVisAsset&gt;(new Guid(&quot;5a761a72-8bcb-11ea-9265-005056bae6d8&quot;))</code> has a type parameter <code>ColormapVisAsset</code>.</p>
<p>The method declaration for the generic method @IVLab.ABREngine.ABREngine.LoadVisAsset might look something like:</p>
<pre><code class="lang-cs">public class ABREngine
{
    public T LoadVisAsset&lt;T&gt;(Guid visAssetID) { ... }
}
</code></pre><p>Here, the compiler knows that wherever it sees a <code>T</code> inside this function it
should replace it with whatever class name you give it when you call the
function.  So, when we write <code>LoadVisAsset&lt;ColormapVisAsset&gt;(...)</code> it&#39;s like
calling a <code>ColormapVisAsset</code>-specific version of the <code>LoadVisAsset</code> function.  It is
good to have this syntax in mind when programming with Unity because some of the
most frequently used function in Unity, like @UnityEngine.GameObject.GetComponent use
the same approach.</p>
<h2 id="part-1-creating-the-abrengine-gameobject-and-configuration">Part 1: Creating the ABREngine GameObject and configuration</h2>
<p>Every ABR visualization needs to have the ABREngine GameObject and configuration correctly set up.</p>
<p>In the Unity Editor &quot;Project&quot; tab, search for ABREngine &quot;In Packages&quot;. Then, drag-and-drop the ABREngine prefab (blue cube icon) into the Hierarchy.
<img src="resources/cs-vis_1-abrengine.png" alt=""></p>
<p>If you click on the ABREngine GameObject you just created, you&#39;ll notice an error message in on the right Inspector panel:
<img src="resources/cs-vis_2-config-error.png" alt=""></p>
<p>To fix this, we need to create an ABR Configuration. In the Project tab, go to your Assets folder. Then, right/two-finger -click anywhere in the empty space and select <em>Create &gt; ABR &gt; ABR Configuration</em>.
<img src="resources/cs-vis_3-config-create.png" alt=""></p>
<p>You may leave it named &quot;ABRConfig&quot;. Inspect the ABRConfig object you just created to see what configuration options are available to you - but for now, we can leave these all at their defaults.
<img src="resources/cs-vis_4-config-edit.png" alt=""></p>
<p>Observe that now, when you click on the &quot;ABREngine&quot; GameObject, the ABRConfig you just created shows up under &quot;Choose ABR Configuration&quot;.
<img src="resources/cs-vis_5-config-check.png" alt=""></p>
<p>Save your scene by pressing Ctrl+S or Cmd+S or navigating to <em>File &gt; Save</em>.</p>
<h2 id="part-2-creating-a-c-script-to-drive-your-visualization">Part 2: Creating a C# Script to drive your visualization</h2>
<p>Some ABR visualizations use the ABR design interface, but in this tutorial we
will solely focus on making a visualization with C# code. We will have a single
script, &quot;VisDriver.cs&quot;, that creates our visualization by creating ABR <a href="key-data.html">key
data</a>, <a href="visassets.html">VisAssets</a> and telling ABR to render these
with <a href="data-impressions.html">data impressions</a>.</p>
<p>First, let&#39;s create a new Empty GameObject. In the Hierarchy, right/two-finger click anywhere in the open space and select <em>Create Empty</em>. Call this GameObject &quot;VisDriverObject&quot;.
<img src="resources/cs-vis_6-create-empty.png" alt=""></p>
<p>Now, create a new C# Script. In the Project tab, right/two-finger click anywhere in the open space an select *Create &gt; C# Script&quot;. Name it &quot;VisDriver&quot;.
<img src="resources/cs-vis_7-create-script.png" alt=""></p>
<p>Lastly, drag and drop this script onto the &quot;VisDriverObject&quot; GameObject you created earlier.
<img src="resources/cs-vis_8-script-drag.png" alt=""></p>
<p>To edit the script, right/two-finger click the &quot;VisDriver&quot; script in the Project
tab and click &quot;Open C# Project&quot;. Before doing this, ensure that your
<a href="https://learn.unity.com/tutorial/set-your-default-script-editor-ide">external script editor</a>
is set up correctly, and that under &quot;Generate .csproj files for:&quot;, &quot;Embedded
Packages&quot;, &quot;Local Packages&quot;, and &quot;Local Tarball&quot; are all checked.</p>
<h2 id="part-3-making-a-visualization">Part 3: Making a visualization</h2>
<p>After clicking &quot;Open C# Project&quot; and navigating to VisDriver.cs in your code
editor, you should see that Unity has populated a new
<a href="https://docs.unity3d.com/Manual/class-MonoBehaviour.html">MonoBehaviour Class</a> named <code>VisDriver</code>.</p>
<p>This part will walk you through the steps to create your first script-based visualization with ABR, which will end up looking like this:</p>
<h3 id="importing-the-abrengine">Importing the ABREngine</h3>
<p>Add the following code to the header of the VisDriver file under <code>using UnityEngine</code>:</p>
<pre><code class="lang-cs">using IVLab.ABREngine;
</code></pre><p>This line of code makes the power of ABR available to you in this script.</p>
<h3 id="1-import-some-data">1. Import some data</h3>
<p>For simplicity, we&#39;re going to put all our visualization code in the <code>Start()</code> method, so you can delete the <code>Update()</code> method at this point.</p>
<p>Now, in the <code>Start()</code> method, we&#39;ll begin by importing some example data that&#39;s available for you to use in ABR. Copy and past the following code into your <code>Start()</code> method:</p>
<pre><code class="lang-cs">// 1.a. Load the dataset from disk (see ABREngine-UnityPackage/Runtime/Resources/media/datasets) for the raw data files
string contourDataPath = &quot;Demo/Wavelet/KeyData/Contour&quot;;
RawDataset contourRaw = ABREngine.Instance.Data.LoadRawDataset&lt;ResourcesDataLoader&gt;(contourDataPath);

// 1.b. Import the contour surface dataset into ABR
ABREngine.Instance.Data.ImportRawDataset(contourDataPath, contourRaw);
</code></pre><h3 id="2-putting-it-together-in-a-data-impression">2. Putting it together in a data impression</h3>
<p>Data impressions are the &quot;layers&quot; of the visualization. So, to combine data and VisAssets, we need to create a data impression and assign data to it:</p>
<pre><code class="lang-cs">// 2. Create surface data impression and assign key data
SimpleSurfaceDataImpression surf = new SimpleSurfaceDataImpression();
surf.keyData = contour;
</code></pre><h3 id="3-registering-and-rendering">3. Registering and rendering</h3>
<p>Finally, to get our data to show up at all, we need to first <code>Register</code> the data impression we created with the ABREngine. This only needs to be done once right after the Data Impression is created.</p>
<pre><code class="lang-cs">// 3.a. Register the data impression so ABR knows about it
ABREngine.Instance.RegisterDataImpression(surf);
</code></pre><p>Then <code>Render()</code> the visualization. This needs to be done every time something changes, such as a colormap or data value.</p>
<pre><code class="lang-cs">// 3.b. Render the visualization
ABREngine.Instance.Render();
</code></pre><p>At this point, check your work. Go back to Unity and press the &quot;Play&quot; button triangle in the top toolbar. If everything is working correctly, you should see a small &quot;blob-like&quot; visualization in the center of your game view - this is the &quot;Contour&quot; data you imported in Step 1!
<img src="resources/cs-vis_9-basic-vis.png" alt=""></p>
<h3 id="4-import-a-colormap-visasset">4. Import a colormap VisAsset</h3>
<p>To add some color to the visualization, we&#39;ll need a colormap. Add the following code to your <code>Start()</code> method. Copy/paste this code right after the existing Step 1 code:</p>
<pre><code class="lang-cs">// 1.c. Import a Colormap VisAsset
ColormapVisAsset cmap = ABREngine.Instance.VisAssets.LoadVisAsset&lt;ColormapVisAsset&gt;(new System.Guid(&quot;5a761a72-8bcb-11ea-9265-005056bae6d8&quot;));
</code></pre><h3 id="5-assign-colormap-and-color-variable-to-data-impression">5. Assign colormap and color variable to data impression</h3>
<p>The data and the colormap visasset are linked together in the <code>surf</code> data impression created in Step 2. Let&#39;s add some more code between steps 2 and 3:</p>
<pre><code class="lang-cs">// 2.b. Assign colormap to data impression
surf.colormap = cmap;

// 2.c. Assign color variable to data impression
surf.colorVariable = contour.GetScalarVariable(&quot;XAxis&quot;);
</code></pre><p>This code will first link the colormap you imported in Step 4 to the data impression, then it will look in the &quot;Contour&quot; key data object and find a scalar variable &quot;XAxis&quot;. See <a href="key-data.html">Key Data</a> for more information on key data.</p>
<p>At this point, go back to Unity and try running the visualization again. After adjusting the camera to be closer to the center of the scene (camera position = (0, 0, -2)), your game view should look like this:
<img src="resources/cs-vis_10-colormap.png" alt=""></p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.umn.edu/ivlab-cs/ABREngine-UnityPackage/blob/master/DocumentationSrc~/manual/creating-cs-abr-vis.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            <a href="https://ivlab.cs.umn.edu">Interactive Visualization Lab</a><br>Copyright 2022, Regents of the University of Minnesota, All Rights Reserved
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
